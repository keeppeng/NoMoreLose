# 分布式

## CAP理论

CAP理论，指的是在一个分布式系统中，Consistency(一致性)、Availability(可用性)、Partition Tolerance(分区容错性)，不能同时成立

在分布式架构的情况下，考虑网络分区的问题，分布式集群依然要对外提供正常的服务

- 数据一致性（consistency）：如果系统对一个写操作返回成功，那么之后的请求都应该能读到这个新的数据，对于调用者而言，数据具有强一致性，即数据是正确的
- 服务可用性（available）：所有的读写请求在一定的时间内得到响应，不会一直等待，分布式系统对外一直是可以提供可用的服务的，也就是一定会返回数据，但是数据有可能不太准确
- 分区容错性（Partition Tolerance）这个是由于分布式系统是通过网络通讯的，但是网络是不完全可靠的，存在数据传输丢失的可能，以及一定的延时性，但是不管数据同步的过程出现什么问题，并不影响整个分布式系统对外提供服务。

但是P 其实在分布式系统中是一定需要保证的，毕竟如果不存在P的话，那么就不是分布式架构了，所以正常我们的分布式系统架构的话一般只会选择CP 或者 AP。

完全CP ： 响应会很慢 会等待数据正确同步之后 服务才会正常响应

完全AP ： 客户端a写了数据在服务器a上 ， 客户端b从服务器b可以在未同步的时候就读到数据，但是读到的是旧数据。

但是事实上，也不存在完全CP或者完全AP架构，都是一个此消彼长的按照实际业务的接受程度来设计的偏CP或者偏AP的架构。

## Base理论

Basically Available(基本可用)、Soft state(软状态)、Eventually Consistent(最终一致性)

BASE 理论是对 CAP 中的一致性和可用性进行一个权衡的结果，理论的核心思想就是：我们无法做到强一致，但每个应用都可以根据自身的业务特点，采用适当的方式来使系统达到最终一致性。

- 基本可用，由强可用变为可用性降低了，原本可能需要保证99.99的可用性，但是降级变为99.9可用，或者响应的时间延时
- 软状态：中间状态，例如添加一个支付中...
- 最终一致性：数据同步可能存在延迟，某个时间段可能节点之间数据是不太一致的，但是在最终必须一致（关于一致性，有些银行相关的业务场景是必须强一致的）

## paxos算法

分布式系统中 强一致性 的解决算法 它是没法直接作为工程化的解决方案的